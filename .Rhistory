if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
#express <- gsub("\\\\", "\\", express)
return(express)
}
#saisonnalitePlot(dd, "DETAIL", order = 0)
# MODELLING ----
writeExpr <- function(coefs, p, q){
expr <- ""
if ("intercept" %in% names(coefs)){
# gestion de l'intercept
intercept = tail(coefs, 1)
cste = intercept * (1 - sum(coefs[1:p]))
c = paste(round(cste,4), " +", sep = "")
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
cat("AR coefs:", ARcoefs, "\n")
for (i in 1:p){
cat("ar",i, "\n")
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[(p+1):(p+q)]
cat("MA coefs:", MAcoefs, "\n")
for (i in 1:q){
cat("ma",i, "\n")
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
cat("MA part:", MAp, "\n")
}
} else {
c = ""
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
for (i in 1:p){
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
express <- gsub("\\\\", "\\", express)
return(express)
}
#saisonnalitePlot(dd, "DETAIL", order = 0)
# MODELLING ----
writeExpr <- function(coefs, p, q){
expr <- ""
if ("intercept" %in% names(coefs)){
# gestion de l'intercept
intercept = tail(coefs, 1)
cste = intercept * (1 - sum(coefs[1:p]))
c = paste(round(cste,4), " +", sep = "")
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
cat("AR coefs:", ARcoefs, "\n")
for (i in 1:p){
cat("ar",i, "\n")
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[(p+1):(p+q)]
cat("MA coefs:", MAcoefs, "\n")
for (i in 1:q){
cat("ma",i, "\n")
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
cat("MA part:", MAp, "\n")
}
} else {
c = ""
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
for (i in 1:p){
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
express <- gsub("\\\\", "\\", express)
return(express)
}
writeExpr(coefs, 1, 1)
#saisonnalitePlot(dd, "DETAIL", order = 0)
# MODELLING ----
writeExpr <- function(coefs, p, q){
expr <- ""
if ("intercept" %in% names(coefs)){
# gestion de l'intercept
intercept = tail(coefs, 1)
cste = intercept * (1 - sum(coefs[1:p]))
c = paste(round(cste,4), " +", sep = "")
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
cat("AR coefs:", ARcoefs, "\n")
for (i in 1:p){
cat("ar",i, "\n")
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[(p+1):(p+q)]
cat("MA coefs:", MAcoefs, "\n")
for (i in 1:q){
cat("ma",i, "\n")
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
cat("MA part:", MAp, "\n")
}
} else {
c = ""
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
for (i in 1:p){
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
express <- gsub("\\\\", "\\\\", express)
return(express)
}
writeExpr(coefs, 1, 1)
#saisonnalitePlot(dd, "DETAIL", order = 0)
# MODELLING ----
writeExpr <- function(coefs, p, q){
expr <- ""
if ("intercept" %in% names(coefs)){
# gestion de l'intercept
intercept = tail(coefs, 1)
cste = intercept * (1 - sum(coefs[1:p]))
c = paste(round(cste,4), " +", sep = "")
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
cat("AR coefs:", ARcoefs, "\n")
for (i in 1:p){
cat("ar",i, "\n")
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[(p+1):(p+q)]
cat("MA coefs:", MAcoefs, "\n")
for (i in 1:q){
cat("ma",i, "\n")
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
cat("MA part:", MAp, "\n")
}
} else {
c = ""
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
for (i in 1:p){
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
express <- gsub("\\", "\\\\", express)
return(express)
}
writeExpr(coefs, 1, 1)
#saisonnalitePlot(dd, "DETAIL", order = 0)
# MODELLING ----
writeExpr <- function(coefs, p, q){
expr <- ""
if ("intercept" %in% names(coefs)){
# gestion de l'intercept
intercept = tail(coefs, 1)
cste = intercept * (1 - sum(coefs[1:p]))
c = paste(round(cste,4), " +", sep = "")
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
cat("AR coefs:", ARcoefs, "\n")
for (i in 1:p){
cat("ar",i, "\n")
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[(p+1):(p+q)]
cat("MA coefs:", MAcoefs, "\n")
for (i in 1:q){
cat("ma",i, "\n")
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
cat("MA part:", MAp, "\n")
}
} else {
c = ""
# partie AR
ARp <- ""
if (p > 0){
ARcoefs <- coefs[1:p]
for (i in 1:p){
if (i == 1){
ARp <- paste(ARp, " (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
} else {
ARp <- paste(ARp, " + (", round(ARcoefs[i],4), ")\\y_{t-", i, "}", sep = "")
}
}
}
# Partie MA
MAp <- ""
if (q > 0){
MAcoefs <- coefs[p+1:(p+q)]
for (i in 1:q){
if (i == 1 && p == 0){
MAp <- paste(MAp, " (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
} else {
MAp <- paste(MAp, " + (", round(MAcoefs[i],4), ")\\epsilon_{t-", i, "}", sep = "")
}
}
}
}
express <- paste("$$\\y_t = ", c, ARp, MAp, "$$", sep = "")
# # coefnames <- names(coefs)
# if (!is.null(remainingcoefs)){
#   for (i in 1:length(coefs)) {
#     if (i==1){
#       expr <- sprintf("$$\\y_t = (%.04f)\\y_{t-1}",coefs[i])
#     }
#
#     if (i %in% 2:p){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\y_{t-", i, "}", sep = "")
#     }
#
#     if (i %in% (p+1):(p+q)){
#       expr <- paste(expr, " + (", round(coefs[i],4), ")\\epsilon_{t-", i-p, "}", sep = "")
#     }
#   }
# } else {
#   expr <- "$$"
# }
#
#
# expr <- paste(expr, "$$", sep = "")
# express <- gsub("\\", "\\\\", express)
return(express)
}
writeExpr(coefs, 1, 1)
coefs
coefs <- c(ar1=-0.0124, ar2=-0.6945, ma1=0.3629, ma2=0.9414, intercept=-0.1288)
coefs
writeExpr(coefs, 2, 2)
m$coef
writeExpr(m$coef, 1, 0)
24.7497971*(1-0.9910996)
runApp()
runApp()
m$residuals
jarque.bera.test(m$residuals)
runApp()
shiny::runApp()
